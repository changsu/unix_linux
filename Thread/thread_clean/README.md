<pre>
chang-mbp:thread_clean chang$ ./thread_clean
thread 1 start
thread 2 start
thread 1 exit code 1
thread 2 push complete
cleanup: thread 2 second handler
cleanup: thread 2 first handler
thread 2 exit code 2
</pre>